{% extends "base.html" %}

{% block title %}Settings - Udemy Course Enroller{% endblock %}

{% block content %}
<div class="bg-gray-800 p-8 rounded-lg shadow-xl">
    <h2 class="text-3xl font-bold text-blue-400 mb-8">Application Settings</h2>
    
    <form method="POST" action="{{ url_for('settings_page') }}" class="space-y-10">
        
        <div>
            <h3 class="text-xl font-semibold text-blue-300 mb-4 border-b border-gray-700 pb-2">Enabled Coupon Sites</h3>
            <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4">
                {% for site_key, site_name in scraper_dict.items() %}
                <label class="flex items-center space-x-3 p-3 bg-gray-700 rounded-lg hover:bg-gray-600 transition-colors cursor-pointer">
                    <input type="checkbox" name="{{ site_key }}" value="true" 
                           class="form-checkbox h-5 w-5 text-blue-500 bg-gray-600 border-gray-500 rounded focus:ring-blue-400"
                           {% if settings.sites[site_key] %}checked{% endif %}>
                    <span class="text-gray-200">{{ site_key }}</span>
                </label>
                {% endfor %}
            </div>
        </div>

        <div>
            <h3 class="text-xl font-semibold text-blue-300 mb-4 border-b border-gray-700 pb-2">Enabled Course Categories</h3>
            <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4">
                {% for cat_key, cat_enabled in settings.categories.items() %}
                <label class="flex items-center space-x-3 p-3 bg-gray-700 rounded-lg hover:bg-gray-600 transition-colors cursor-pointer">
                    <input type="checkbox" name="{{ cat_key }}" value="true"
                           class="form-checkbox h-5 w-5 text-blue-500 bg-gray-600 border-gray-500 rounded focus:ring-blue-400"
                           {% if cat_enabled %}checked{% endif %}>
                    <span class="text-gray-200">{{ cat_key }}</span>
                </label>
                {% endfor %}
            </div>
        </div>

        <div>
            <h3 class="text-xl font-semibold text-blue-300 mb-4 border-b border-gray-700 pb-2">Enabled Course Languages</h3>
            <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4">
                {% for lang_key, lang_enabled in settings.languages.items() %}
                <label class="flex items-center space-x-3 p-3 bg-gray-700 rounded-lg hover:bg-gray-600 transition-colors cursor-pointer">
                    <input type="checkbox" name="{{ lang_key }}" value="true"
                           class="form-checkbox h-5 w-5 text-blue-500 bg-gray-600 border-gray-500 rounded focus:ring-blue-400"
                           {% if lang_enabled %}checked{% endif %}>
                    <span class="text-gray-200">{{ lang_key }}</span>
                </label>
                {% endfor %}
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div>
                <label for="min_rating" class="block text-sm font-medium text-gray-300 mb-1">Minimum Rating (0.0 - 5.0)</label>
                <input type="number" name="min_rating" id="min_rating" step="0.1" min="0" max="5" 
                       value="{{ settings.min_rating }}"
                       class="mt-1 block w-full bg-gray-700 border-gray-600 text-gray-200 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2.5">
            </div>
            <div>
                <label for="course_update_threshold_months" class="block text-sm font-medium text-gray-300 mb-1">Course Update Threshold (Months)</label>
                <input type="number" name="course_update_threshold_months" id="course_update_threshold_months" step="1" min="1"
                       value="{{ settings.course_update_threshold_months }}"
                       class="mt-1 block w-full bg-gray-700 border-gray-600 text-gray-200 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2.5">
            </div>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div>
                <label for="instructor_exclude" class="block text-sm font-medium text-gray-300 mb-1">Exclude Instructors (one per line)</label>
                <textarea name="instructor_exclude" id="instructor_exclude" rows="4"
                          class="mt-1 block w-full bg-gray-700 border-gray-600 text-gray-200 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2.5">{{ settings.instructor_exclude|join('\n') }}</textarea>
            </div>
            <div>
                <label for="title_exclude" class="block text-sm font-medium text-gray-300 mb-1">Exclude Title Keywords (one per line, not case-sensitive)</label>
                <textarea name="title_exclude" id="title_exclude" rows="4"
                          class="mt-1 block w-full bg-gray-700 border-gray-600 text-gray-200 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2.5">{{ settings.title_exclude|join('\n') }}</textarea>
            </div>
        </div>

        <div class="space-y-4">
            <label class="flex items-center space-x-3 p-3 bg-gray-700 rounded-lg hover:bg-gray-600 transition-colors cursor-pointer w-max">
                <input type="checkbox" name="save_txt" value="true"
                       class="form-checkbox h-5 w-5 text-blue-500 bg-gray-600 border-gray-500 rounded focus:ring-blue-400"
                       {% if settings.save_txt %}checked{% endif %}>
                <span class="text-gray-200">Save enrolled courses in .txt file</span>
            </label>
            <label class="flex items-center space-x-3 p-3 bg-gray-700 rounded-lg hover:bg-gray-600 transition-colors cursor-pointer w-max">
                <input type="checkbox" name="discounted_only" value="true"
                       class="form-checkbox h-5 w-5 text-blue-500 bg-gray-600 border-gray-500 rounded focus:ring-blue-400"
                       {% if settings.discounted_only %}checked{% endif %}>
                <span class="text-gray-200">Enroll in discounted (paid with 100% coupon) courses only (exclude free courses)</span>
            </label>
        </div>

        <div class="pt-6">
            <button type="submit"
                    class="btn btn-primary w-full sm:w-auto">
                Save Settings
            </button>
        </div>
    </form>
</div>
{% endblock %}
